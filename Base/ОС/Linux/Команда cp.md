202104281325
Tags:
___
 # Команда cp - копирование файлов из каталогов
Она не копирует каталоги по умолчанию рекурсивно, поэтому не забудьте добавить опцию -r (Recursive) или -a (Archive). Последняя включает режим сохранения атрибутов, владельца и временного штампа в дополнение к рекурсивному копированию.

Общий синтаксис cp выглядит вот так:
`cp опции файл-источник файл-приемник`

Или:
`cp опции файл-источник директория-приемник/`

После выполнения команды файл-источник будет полностью перенесен в файл-приемник. Если в конце указан слэш, файл будет записан в заданную директорию с оригинальным именем.

`--attributes-only` - не копировать содержимое файла, а только флаги доступа и владельца;
`-f`, `--force` - перезаписывать существующие файлы;
`-i`, `--interactive` - спрашивать, нужно ли перезаписывать существующие файлы;
`-L` - копировать не символические ссылки, а то, на что они указывают;
`-n` - не перезаписывать существующие файлы;
`-P` - не следовать символическим ссылкам;
`-r` - копировать папку Linux рекурсивно;
`-s` - не выполнять копирование файлов в Linux, а создавать символические ссылки;
`-u` - скопировать файл, только если он был изменён;
`-x` - не выходить за пределы этой файловой системы;
`-p` - сохранять владельца, временные метки и флаги доступа при копировании;
`-t` - считать файл-приемник директорией и копировать файл-источник в эту директорию.

Копирование папок осуществляется с помощью ключа -r.
`cp -R ~/папка ~/Документы/`

После выполнения этой команды копирования ~/папка будет скопирована в папку ~/Документы. Главное, не забывайте поставить слэш в конце выражения или использовать опцию -t. Иначе папка ~/документы будет перезаписана.

>**Consider This**
>
Permissions can have an impact on file management commands, such as the `cp` command. In order to copy a file, it is necessary to have execute permission to access the directory where the file is located and the read permission for the file being copied.
>
It is also necessary to have write and execute permission on the directory the file is being copied to. Typically, there are two places where you should always have write and execute permission on the directory: your home directory and the `/tmp` directory.
          
#### КОПИРОВАНИЕ ФАЙЛОВ ПО РЕГУЛЯРНЫМ ВЫРАЖЕНИЯМ

В утилите find можно применять различные условия и регулярные выражения для поиска файлов. Мы можем скопировать все найденные с помощью find файлы, вызвав для каждого из них команду cp. Например, копируем все файлы в текущей директории, содержащие в имени только цифры:

` find . -name [0-9] -exec cp {} ~/Документы \`

Здесь точка указывает на текущую директорию, а параметр name задает регулярное выражение. Параметром exec мы задаем, какую команду нужно выполнить для обнаруженных файлов. Символ {} - подставляет имя каждого файла.

Но не find'ом единым такое делается. То же самое можно получить, запросив список файлов директории в ls, отфильтровав его по регулярному выражению egrep и передав имена файлов по очереди в cp с помощью xargs:

` ls -1 ~/ | egrep '[a-zA-Z]' | xargs cp -t ~/Папка/`

Это не совсем удобный способ копировать файлы Linux, но всё же он возможен. Будут скопированы все файлы из домашней директории, содержащие в имени только английские буквы.

#### КОПИРОВАНИЕ СОДЕРЖИМОГО ФАЙЛОВ В LINUX

Вы можете не только копировать сами файлы, но и управлять их содержимым. Например, склеить несколько файлов в один или разрезать файл на несколько частей. Утилита cat используется для вывода содержимого файла, в комбинации с операторами перенаправления вывода Bash вы можете выполнять копирование содержимого файла Linux в другой файл. Например:

` cat файл1 > файл2`
Если файл был не пустым, он будет перезаписан. Или мы можем склеить два отдельных файла в один:

` cat файл1 файл2 > файл3`

#### СПЕЦИАЛЬНОЕ КОПИРОВАНИЕ ФАЙЛОВ В LINUX С ПОМОЩЬЮ TAR
           
Копирование в Linux тоже может быть выполнено не только с помощью cp. При переносе системных файлов в другой каталог, резервном копировании системных файлов и т.д. важно чтобы сохранились атрибуты, значения владельцев файлов и символические ссылки как они есть без какой-либо модификации.

Утилита cp тоже может справиться с такой задачей? если указать опцию -p, но можно использовать утилиту архивации tar. Мы не будем создавать никаких файлов архивов, а построим туннель. Первая часть команды пакует файл и отправляет на стандартный вывод, а другая сразу же распаковывает в нужную папку:

` tar cf - /var | ( cd /mnt/var && tar xvf - )`

Здесь мы полностью копируем содержимое папки /var в папку /mnt/var. Так вы можете копировать папку Linux, причём абсолютно любую или даже целую операционную систему.


___
##### Links


---
##### Источники
