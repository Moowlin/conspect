Условия задачи

В базе данных риелторской компании есть три таблицы.  
1) Таблица "client", которая содержит информацию о клиентах компании. Она содержит поля:  
	- "id" – уникальный идентификатор клиента;  
	- "first_name" – имя клиента;  
	- "last_name" – фамилия клиента.  
2) Таблица "apartment", которая содержит информацию о продаваемых квартирах. Она содержит поля:  
	- "id" – уникальный идентификатор квартиры;  
	- "address" – адрес квартиры;  
	- "rooms" – количество комнат в квартире.  
3) Таблица "view", которая содержит информацию о записи на просмотр квартир клиентами. Она содержит поля:  
	- "id" – уникальный идентификатор записи;  
	- "apartment_id" – идентификатор квартиры;  
	- "client_id" – идентификатор клиента, записанного на просмотр;  
	- "date" – дата просмотра квартиры.  
  
Обратите внимание, что на просмотр одной квартиры могут записаться несколько клиентов, а один клиент может записаться на просмотр нескольких квартир.  
  
Ниже представлена схема описанной базы данных.

![[n64zBA0N599s-ih4XaIWgS4Z6wcRKa0HHR4XF6KIFKQ5V5LLdjKim-MZkYKzLWxQZ361HJsZfnbRSqpPpJGEoaMvdU868Q9C86eCqT3NTys9MVRC_cEqWaQU8BSPl-vmVA=w793.png]]

Исходя из описания и схемы базы данных, составьте SQL-запрос, результатом которого будет список фамилий клиентов, записанных на просмотр двух и более трехкомнатных квартир.

ОТВЕТ мой: 
```SQL
SELECT last_name 
FROM client 
JOIN view ON view.client_id = client.id 
JOIN apartment ON view.apartment_id = apartment.id 
WHERE view.client_id IN 
	( SELECT count(*) 
	 FROM view 
	 GROUP BY client_id 
	 HAVING count(*)>=2 ) 
AND rooms = 3;
```