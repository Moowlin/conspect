202201131437
Tags:
___
# Предложение JOIN

Предложение JOIN используется для объединения строк из двух или более таблиц на основе соответствующего столбца между ними.

Существует несколько типов JOIN в SQL:

-   **(INNER) JOIN** - возвращает записи, имеющие соответствующие значения в обеих таблицах
-   **LEFT (OUTER) JOIN** - возвращает все записи из левой таблицы и соответствующие записи из правой таблицы
-   **RIGHT (OUTER) JOIN** - вернуть все записи из правой таблицы и сопоставленные записи из левой таблицы
-   **FULL (OUTER) JOIN** - возвращает все записи, когда есть совпадение в левой или правой таблице

![[Pasted image 20220113143858.png]]

## Оператор INNER JOIN
Оператор SQL INNER JOIN формирует таблицу из записей двух или нескольких таблиц. Каждая строка из первой (левой) таблицы, сопоставляется с каждой строкой из второй (правой) таблицы, после чего происходит проверка условия. Если условие истинно, то строки попадают в результирующую таблицу. В результирующей таблице строки формируются конкатенацией строк первой и второй таблиц.

Оператор SQL INNER JOIN имеет следующий синтаксис:
```sql
SELECT
    column_names [,... n]
FROM
    Table_1 INNER JOIN Table_2
ON table1.column_name = table2.column_name;
```

### Пример INNER JOIN

Следующий оператор SQL выбирает все заказы с информацией о пользователях:

**Пример:**

```sql
SELECT invoice.invoice_id, users.name
FROM invoice
INNER JOIN users ON invoice.user_id = users.user_id;
```

Ключевое слово INNER JOIN выбирает все строки из обеих таблиц, если существует совпадение между столбцами. Если в таблице «invoice» есть записи, которые не имеют совпадений в «users», то записи не будут отображены.

### JOIN Three таблиц

Следующий оператор SQL выбирает все счета с информацией о пользователях и отправителях:

**Пример:**

```sql
SELECT invoice.invoice, users.name, addresser.name
FROM ((invoice
INNER JOIN users ON invoice.user_id = users.user_id)
INNER JOIN addresser ON invoice.addresser_id = addresser.addresser_id);
```


## Оператор  LEFT JOIN
Оператор SQL LEFT JOIN осуществляет формирование таблицы из записей двух или нескольких таблиц. В операторе SQL LEFT JOIN, как и в операторе SQL RIGHT JOIN, важен порядок следования таблиц, так как от этого будет зависеть полученный результат. 

Алгоритм работы оператора следующий:
1. Сначала происходит формирование таблицы внутренним соединением (оператор SQL INNER JOIN) левой и правой таблиц
2. Затем, в результат добавляются записи левой таблицы не вошедшие в результат формирования таблицы внутренним соединением. Для них, соответствующие записи из правой таблицы заполняются значениями NULL.

Оператор SQL LEFT JOIN имеет следующий синтаксис:
```sql
SELECT
    column_names [,... n]
FROM
    Table_1 LEFT JOIN Table_2
ON table1.column_name = table2.column_name;
```

### Пример SQL LEFT JOIN

Следующий оператор SQL выберет всех пользователей и любые заказы, которые они могут иметь:

**Пример:**

```sql
SELECT users.name, invoice.invoice_id
FROM users
LEFT JOIN invoice ON users.user_id = invoice.user_id
ORDER BY users.name;
```


## Оператор RIGHT JOIN

Оператор SQL RIGHT JOIN осуществляет формирование таблицы из записей двух или нескольких таблиц. В операторе SQL RIGHT JOIN, как и в операторе SQL LEFT JOIN], важен порядок следования таблиц, так как от этого будет зависеть полученный результат. Алгоритм работы оператора следующий:

1.  Сначала происходит формирование таблицы внутренним соединением (оператор SQL INNER JOIN левой и правой таблиц
2.  Затем, в результат добавляются записи левой таблицы не вошедшие в результат формирования таблицы внутренним соединением. Для них, соответствующие записи из левой таблицы заполняются значениями NULL.

Оператор SQL RIGHT JOIN имеет следующий синтаксис:
```sql
SELECT
    column_names [,... n]
FROM
    Table_1 RIGHT JOIN Table_2 ON table1.column_name = table2.column_name;
```

### Пример SQL RIGHT JOIN

Следующий оператор SQL вернет всех пользователей и любые заказы, которые они могли бы разместить:

**Пример:**

```sql
SELECT invoice.invoice_id, users.name, users.fullname
FROM invoice
RIGHT JOIN users ON invoice.user_id = users.user_id
ORDER BY invoice.invoice_id;
```


## Оператор FULL JOIN

Оператор SQL FULL JOIN осуществляет формирование таблицы из записей двух или нескольких таблиц. В операторе SQL FULL JOIN не важен порядок следования таблиц, он никак не влияет на окончательный результат, так как оператор является симметричным.

Оператор SQL FULL JOIN можно воспринимать как сочетание операторов SQL INNER JOIN + SQL LEFT JOIN + SQL RIGHT JOIN. Алгоритм его работы следующий:

1. Сначала формируется таблица на основе внутреннего соединения (оператор SQL INNER JOIN).
2. Затем, в таблицу добавляются значения не вошедшие в результат формирования из правой таблицы (оператор SQL LEFT JOIN). Для них, соответствующие записи из правой таблицы заполняются значениями NULL.
3. Наконец, в таблицу добавляются значения не вошедшие в результат формирования из левой таблицы (оператор SQL RIGHT JOIN). Для них, соответствующие записи из левой таблицы заполняются значениями NULL.

Оператор SQL FULL JOIN имеет следующий синтаксис:
```sql
SELECT
    column_names [,... n]
FROM
    Table_1 FULL JOIN Table_2
ON table1.column_name = table2.column_name;
```
### Пример SQL FULL OUTER JOIN

Следующий оператор SQL выбирает всех пользователей и все заказы:

```sql
SELECT users.name, invoice.invoice_id
FROM users
FULL OUTER JOIN invoice ON users.user_id = invoice.user_id
ORDER BY users.name;
```

# Ссылки
___
##### Links


---
##### Источники

http://2sql.ru/advanced/sql-full-join/
https://schoolsw3.com/sql/sql_join.php

https://unetway.com/tutorial/sql-predlozenie-j