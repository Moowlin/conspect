202104221248
Tags:
___
# Обзор протокола HTTP
HTTP - _HyperText Transfer Protocol_, «протокол передачи гипертекста». В соответствии со спецификацией OSI, HTTP является протоколом прикладного (верхнего, 7-го) уровня. Актуальная версия протокола HTTP 1.1 описана в спецификации RFC 2616.

**HTTP** — широко распространённый протокол передачи данных, изначально предназначенный для передачи гипертекстовых документов

HTTP является протоколом клиент-серверного взаимодействия, что означает инициирование запросов к серверу самим получателем, обычно веб-браузером (web-browser). Полученный итоговый документ будет (может) состоять из различных поддокументов являющихся частью итогового документа: например, из отдельно полученного текста, описания структуры документа, изображений, видео-файлов, скриптов и многого другого.

Как правило, передача данных по протоколу HTTP осуществляется через TCP/IP-соединения. Серверное программное обеспечение при этом обычно использует TCP-порт 80

## Существует два типа HTTP сообщений: ==запрос== и ==ответ==
*HTTP-протокол состоит только из текста*

Каждое сообщение состоит из трех частей:
1. Стартовая строка (Starting line) — определяет служебные данные.
2. Заголовки (Headers) — описание параметров сообщения. это набор пар имя-значение, разделенных двоеточием. В заголовках передается различная служебная информация: кодировка сообщения, название и версия браузера, адрес, с которого пришел клиент (Referrer) и так далее.  
3. Тело сообщения (Body) — данные сообщения. Должны отделяться от заголовков пустой строкой. В ответе передаваемыми данными, как правило, является html-страница, которую запросил браузер, а в запросе, например, в теле сообщения передается содержимое файлов, загружаемых на сервер. Но как правило, тело сообщения в запросе вообще отсутствует.

Синтаксис запроса:
`METHOD URI HTTP / VERSION`

`METHOD` — это как раз метод HTTP-запроса,
`URI` — идентификатор ресурса, 
`VERSION` — версия протокола (на данный момент актуальна версия 1.1). 

**Метод** представляет собой последовательность из любых символов, кроме управляющих и разделителей, и определяет операцию, которую нужно осуществить с указанным ресурсом.
**URI**(_Uniform Resource Identifier_, унифицированный идентификатор ресурса) — путь до конкретного ресурса (например, документа), над которым необходимо осуществить операцию
**Версия** определяет, в соответствии с какой версией стандарта HTTP составлен запрос.

Стартовая строка ответа имеет следующую структуру:
`HTTP/Версия Код состояния Пояснение`

**Версия **протокола здесь задаётся так же, как в запросе.
**Код состояния** (_Status Code_) — три цифры (первая из которых указывает на класс состояния), которые определяют результат совершения запроса.
**Пояснение** к коду состояния (_Reason Phrase_) — текстовое (но не включающее символы _CR_ и _LF_) пояснение к коду ответа, предназначено для упрощения чтения ответа человеком.


### HTTP-запрос
```
GET / HTTP/1.1 
Host: javarush.ru 
User-Agent: firefox/5.0 (Linux; Debian 5.0.8; en-US; rv:1.8.1.7)
```
В стартовой строке указаны:
- GET — метод запроса;
- / — путь запроса (path);
- HTTP/1.1 — версия протокола передачи данных.

Затем следуют заголовки:
- Host — хост, которому адресован запрос;
- User-Agent — клиент, который отправляет запрос.

Тело сообщения отсутствует. 
>В HTTP-запросе обязательны только стартовая строка и заголовок Host.
>HTTP-запрос должен содержать какой-то метод.

Всего 9 методов: GET, POST, PUT, OPTIONS, HEAD, PATCH, DELETE, TRACE, CONNECT. Самые распространенные — GET и POST.

==GET== — запрашивает контент из сервера
==POST== — публикует информацию на сервере. POST-запрос может передавать разную информацию: параметры в формате ключ=значение, JSON, HTML-код или даже файлы. Вся информация передается в теле сообщения.

>*Пример POST-запрос:*
>```
>POST /user/create/json HTTP/1.1 
>Accept: application/json 
>Content-Type: application/json 
>Content-Length: 28 
>Host: javarush.ru 
>
>{ 
>	"Id": 12345, 
>	"User": "John" 
>}
>```
>Запрос отправляется по адресу javarush.ru/user/create/json
>версия протокола — HTTP/1.1
>Accept указывает, какой формат ответа клиент ожидает получить
>Content-Type — в каком формате отправляется тело сообщения
>Content-Length — количество символов в теле

Чаще всего методы используются в [[Веб-формы|HTML формах]], гиперссылках и AJAX запросах.

### HTTP-ответы
После получения запроса, сервер его обрабатывает и отправляет ответ клиенту:
```
HTTP/1.1 200 OK 
Content-Type: text/html; charset=UTF-8 
Content-Length: 98 

<html> 
	<head> 
		<title>An Example Page</title> 
	</head> 
	<body> 
		<p>Hello World</p> 
	</body> 
</html>
```
Стартовая строка в респонсе содержит версию протокола (HTTP/1.1)
Код статуса (200)
В заголовках — тип и длина контента
В теле ответа — HTML-код, который браузер прорисует в HTML-страницу.

## Краткий обзор HTTP методов
1. **метод GET**  для получения информации от сервера по заданному URI
2. **метод HEAD** работает точно так же, как GET, но в ответ сервер посылает только заголовки и статусную строку без тела HTTP сообщения
3. **метод POST** для отправки данных на сервер, например, из HTML форм, которые заполняет посетитель сайта
4. **метод PUT**  для загрузки содержимого запроса на указанный в этом же запросе URI
5. **метод DELETE** удаляет указанный в URI ресурс
6. **метод CONNECT** преобразует существующее соединение в тоннель
7. **метод OPTIONS** для получения параметров текущего HTTP соединения
8. **метод TRACE** создает петлю, благодаря которой клиент может увидеть, что происходит с сообщением на всех узлах передачи
9. **метод PATCH** Аналогично PUT, но применяется только к фрагменту ресурса

## HTTP - заголовки
![[http_diagram.png]]
**Заголовки HTTP** позволяют клиенту и серверу отправлять дополнительную информацию с HTTP запросом или ответом. В HTTP-заголовке содержится не чувствительное к регистру название, а затем после (`:`) непосредственно значение. Пробелы перед значением игнорируются.

HTTP-заголовки сопровождают обмен данными по протоколу HTTP. Они могут содержать описание данных и информацию, необходимую для взаимодействия между клиентом и сервером. Заголовки и их статусы перечислены в реестре IANA, который постоянно обновляется.

Все заголовки разделяются на четыре основных группы:

1. *General Headers (Общие заголовки)* — применяется как к запросам, так и к ответам, но не имеет отношения к данным, передаваемым в теле..
2. *Request Headers (Заголовки запроса)* — содержит больше информации о ресурсе, который нужно получить, или о клиенте, запрашивающем ресурс.
3. *Response Headers (Заголовки ответа)* — содержат дополнительную информацию об ответе, например его местонахождение, или о сервере, предоставившем его
4. *Entity Headers (Заголовки сущности)* — сопровождают каждую сущность сообщения. Используются в запросах и ответах. Cодержат информацию о теле ресурса, например его длину содержимого или тип MIME.

Именно в таком порядке рекомендуется посылать заголовки получателю (программно это не имеет значения, однако даёт удобство при отладке).

`Host` - ==RqH== - содержит имя домена, для которого предназначен запрос и, опционально, номер порта. 
Необходимо для поддержки виртуального хостинга на серверах.
`Host: ru.wikipedia.org`

Если порт не указан, то используется умолчательный порт протокола/сервиса (например «80» для HTTP, "443" для HTTPS и т.д.).

Каждый HTTP/1.1 запрос должен содержать один и только один заголовок **Host**, в ином случае ответ будет с кодом статуса `400` (Bad Request).

`Location` - ==RsH== - возвращает URI, по которому клиенту следует перейти (ответ с кодом 3хх (перенаправление)) или URI созданного ресурса (код ответа 201). 


# Ссылки
___
##### Links
[[Протокол HTTPS]]
[[Rest]]
[[Коды состояния HTTP]]
[[Постоянное соединение в HTTP]]
[[Кэширование в HTTP]]
[[Прикладной уровень#HTTP vs HTTPS]]


---
##### Источники
https://habr.com/ru/post/215117/
https://habr.com/ru/post/50147/

https://developer.mozilla.org/ru/docs/Web/HTTP/Overview
https://firstssl.ru/faq/general-questions/chto-takoe-https#:~:text=HTTPS%20%E2%80%94%20%D0%BF%D1%80%D0%BE%D1%82%D0%BE%D0%BA%D0%BE%D0%BB%20%D0%B1%D0%B5%D0%B7%D0%BE%D0%BF%D0%B0%D1%81%D0%BD%D0%BE%D0%B9%20%D0%BF%D0%B5%D1%80%D0%B5%D0%B4%D0%B0%D1%87%D0%B8%20%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D1%85,%D0%BF%D0%BE%D0%B4%D0%B4%D0%B5%D1%80%D0%B6%D0%B8%D0%B2%D0%B0%D0%B5%D1%82%20%D1%82%D0%B5%D1%85%D0%BD%D0%BE%D0%BB%D0%BE%D0%B3%D0%B8%D1%8E%20%D1%88%D0%B8%D1%84%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F%20TLS%2FSSL.