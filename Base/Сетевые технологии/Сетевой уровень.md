202201101140
Tags:
___
# Сетевой уровень в модели взаимодействия открытых систем OSI

> Сетевой уровень в модели OSI (Network Layer) нужен, чтобы построить крупную, составную сеть, на основе отдельных сетей, каждая из которых построена на различных технологиях.

## Назначение сетевого уровня

На канальном уровне можно передавать информацию между компьютерами разными способами: 

-   передавать по проводам используя технологию Ethernet; 
-   и без проводов с помощью WI FI. 

Если мы хотим построить сеть, которая охватывает весь мир с помощью технологий канального уровня, у нас возникают проблемы: 

-   Технологий канального уровня много и они отличаются друг от друга, как объединять эти технологии — непонятно. 
-   Ограничение по масштабируемости. Технологии канлаьного уровня хорошо подходят для создания локальных сетей, но плохо для глобальных.

## Различия сетей

Рассмотрим отличия технологий канального уровня на основе которых создаются сети. 

-   *Сервис*. Во-первых могут отличаться уровнем сервиса. В интернет применяется уровень сервиса без гарантии доставки (Ethernet). Никак не проверяется дойдет ли информация или нет. В вай фай используется гарантия доставки. Отправитель передает кадр, после этого ждет подтверждение, затем, прием этого кадра и только потом передает следующий. Если подтверждение приема не пришло, то кадр передается еще раз. Возможен другой уровень сервиса с гарантией того, что доставка произойдет и сохранится порядок следования сообщений. 
-   *Адресация*.В изернет и wi-fi используются MAК-адреса. В сетях сотовой связи используются IMEI-адреса. В других канальных технологиях могут использоваться адреса других типов. Схемы адресации могут отличаться, в Ethernet используется плоская схема, но могут быть сложные схемы адресации — например иерархическая. 
-   *Широковещание*. Может поддерживаться и не поддерживаться в технологии канального уровня. 
-   *Максимальный размер кадра (MTU)*. Может быть передан через сеть построенную по этой технологии. В Изернет размер кадра 1,5к байт, а в вайфай 2304 байта. 
-   *Формат кадра*. Разные технологии канального уровня могут использовать различный формат кадра.


## Согласование различий в сетях

Что можно сделать на сетевом уровне, чтобы согласовать различия в сетях. 

### Тип сервиса

Чтобы согласовать тип сервиса — устройство, которое объединяет сети, может обеспечивать разные типы сервисов в разных сетях. Например, некое устройство принимает данные из вайфай и отправляет подтверждение о получении кадра, а затем передает кадр в изернет, где же подтверждение не используется. В таком случае устройство объединяющее сети, само отправляет подтверждение сети вайфай, и не ждет подтверждения от получателя, который работает в сети ethernet и не отправляет подтверждений о получении. 

### Адресация

*Чтобы согласовать адреса на сетевом уровне вводятся глобальные типы адресов.* Это адреса устройств в составной сети, которые не зависят от адресов в конкретных технологиях канального уровня. Когда используется такой тип адресации, каждое устройство в сети содержит два адреса: глобальный и локальный, поэтому нам нужны механизмы определения локального адреса по глобальному. 

### Широковещание

Чтобы реализовать широковещание в сети, которая его не поддерживает, устройство которое объединяет сети, может отправлять широковещательный кадр всем устройствам сети в отдельности. 

### Фрагментация

Что делать с максимальным размером пакета в сетях? Когда мы передаем данные от отправителя к получателю составной сети, мы не можем заранее знать, какие сети нам встретятся по пути и какой там размер кадра. Поэтому не можем заранее выбрать правильный размер. Чтобы согласовать размер в технологиях канального уровня, на сетевом уровне используется фрагментация.


## Масштабируемость Ethernet
Ethernet и другие технологии канального уровня не подходят для создания крупной сети, которая может охватить весь мир из-за того, что у них есть существенные ограничения по масштабируемости.

Ограничения:
- Коммутаторы изернет для передачи кадра пользуются таблицами коммутации. И эта таблица должна содержать все MAК-адреса компьютеров в сети. Для локально сети норм, для глобальной - хреново
- если коммутатор не понимает куда отправлять кадр, он передает его на все порты. В локальных - норм, в глобальной - хреново
- отсутствие дублирующих путей между коммутаторами. В Ethernet есть технология STP, которая позволяет создавать несколько связей между коммутаторами, но в каждый момент времени активно всего одно соединение.

### Масштабируемость на сетевом уровне
Что делает сетевой уровень, чтобы обеспечить масштабирование и построить такую сеть, которая способна объединить все компьютеры во всем мире, например сеть интернет.

- агрегация адресов. Сетевой уровень работает не с отдельными адресами, а с группами адресов, которые объединяются и такие блоки адресов называются сетью.
- Пакеты, для которых путь доставки неизвестен на сетевом уровне отбрасываются. Это обеспечивает защиту составной сети от циркуляции мусорных пакетов.
-  возможность наличия нескольких активных путей в сети. Это является одной из причин создания сетей с пакетной коммутацией.


## Задачи сетевого уровня
-  объединение сетей (internetworking), создание составной сети на основе сетей построенных на разных технологиях канального уровня, которые могут существенно отличаться друг от друга.
-  маршрутизация. Поиск пути в такой составной сети, где у нас может быть одновременно несколько активных соединений.
-  обеспечение качества обслуживания.


## Маршрутизация и оборудование для сетевого уровня

**Сетевой уровень** занимается разработкой маршрутов доставки пакетов от отправителя до получателя - Маршрутизация (routing). Чтобы добраться до пункта назначения, пакету может потребоваться преодолеть несколько транзитных участков между маршрутизаторами.

>Сетовой уровень должне обладать информацией о топологии сети и выбирать нужный путь по этой сети.

>Протоколы сетевого уровня маршрутизируют данные от источника к получателю и могут быть разделены на два класса: протоколы с установкой соединения и без него.


На третьем уровне появляется новое понятие — *маршрутизация*. Для этой задачи были созданы устройства третьего уровня — *маршрутизаторы* (их еще называют роутерами). Маршрутизаторы получают MAC-адрес от коммутаторов с предыдущего уровня и занимаются построением маршрута от одного устройства к другому с учетом всех потенциальных неполадок в сети.

Маршрутизатор — это устройство для объединения сетей. У маршрутизатора есть некое количество интерфейсов, через них к маршрутизатору подключается сеть.

![[Pasted image 20220110124145.png]]


На сетевом уровне активно используется [[Протокол ARP| протокол ARP]] (Address Resolution Protocol — протокол определения адреса). С помощью него 64-битные MAC-адреса преобразуются в 32-битные IP-адреса и наоборот, тем самым обеспечивается инкапсуляция и декапсуляция данных.

У каждого интерфейса маршрутизатора есть адрес IP31 IP34. Для сравнения, у интерфейса коммутатора своих адресов нет. Если мы хотим объединить несколько сетей, нам обязательно нужен маршрутизатор. Нельзя просто взять и подключить одну сеть к другой, и передавать данные напрямую, нужно использовать маршрутизаторы.


## Сетевой уровень в TCP/IP

На стеке протоколов в tcp/ip достаточно много протоколов, основной протокол это [[Протокол IP| IP (интернет протокол)]] он используется для отправки данных. 
Также есть 3 протокола: 
[[Протокол ICMP | ICMP]] — используется для управления сетью. 
[[Протокол ARP | ARP]] — используется, чтобы с помощью глобального адреса сетевого уровня, определить локальный адрес в технологии канального уровня. 
[[Протокол DHCP | DHCP]] протокол динамической конфигурации хостов, используется, чтобы автоматически назначать IP адреса компьютерам в составной сети.



![[stek-tcp.jpg]]

==Протокол IP так же как и Ethernet использует передачу данных без установки соединения.==



# Ссылки
___
##### Links



---
##### Источники
