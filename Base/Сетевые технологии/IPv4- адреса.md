202201101634
Tags:
___
# IPv4- адреса

Длина адреса IPv4 — 32 бита, 4 байта. И чтобы людям было удобно работать с такими IP адресами их делят на 4 части.
![[Pasted image 20220110163453.png]]

В каждой части по 8 бит, такая часть называется октет. Каждый октет записывают в десятичном формате, и форма записи IP адреса следующая: четыре октета разделенных точкой (213.180.193.3). С таким видом деления адресов людям гораздо удобнее работать, чем с записью в двоичной форме длиной в 32 бита.



## Структура IP адреса

>IP-адрес состоит из двух частей: номера сети и номера узла.

Номер узла в протоколе IP назначается независимо от локального адреса узла. 

Маршрутизатор по определению входит сразу в несколько сетей. Поэтому каждый порт маршрутизатора имеет собственный IP-адрес. Конечный узел также может входить в несколько IP-сетей. В этом случае компьютер должен иметь несколько IP-адресов, по числу сетевых связей. Таким образом, IP-адрес характеризует не отдельный компьютер или маршрутизатор, а одно сетевое соединение.

Наш IP адрес состоит из 2 частей:

1.  номер подсети — старшие биты IP адреса.
2.  номер компьютера в сети (хост) — младшие биты IP адреса.

Рассмотрим пример:

-   IP-адрес: первые три октета (**213.180.193**.3) это адрес сети. Последний октет это адрес хоста (3).
-   Адрес подсети записываем: 213.180.193.0
-   Номер хоста: 3 (0.0.0.3).

## Маска подсети

Как по IP адресу узнать, где адрес сети, а где адрес хоста. Для этого используется Маска подсети. Маска также, как IP адрес состоит из 32 бит, и она устроена следующим образом: там где в IP адресе находится номер сети маска содержит 1, а там где указан номер хоста 0.


Есть два способа указать маску подсети. Десятичное представление в виде префикса.  
В десятичном представление маска записывается в формате похожем на формат IP адреса. 32 разделенные на 4 октета по 8 бит и каждый из этих 8 бит переведены в десятичное представление, они записываются через точку.

Маска в десятичном представление выглядит так 255.255.255.0
![[Pasted image 20220110163748.png]]

>Важно понимать, что маска подсети не обязательно должна заканчиваться на границе октетов.



## Устаревшие классы IP адресов
Изначально весь диапазон адресов был поделен на классы, каждый класс отличался количеством адресов, выдаваемых конечным устройствам

| Класс | Диапазон  первого октета | Диапазон  номеров сети | Кол-во хостов в сети | Маска | Префикс |
| --- | --- | --- | --- | --- | ---| 
| A | 1 – 126 | 1.0.0.0 – 126.0.0.0 | 2^24 – 2 (~16,7\*10^6) | 255.0.0.0 | /8 |
| B | 128 – 191 | 128.0.0.0 – 191.255.0.0 | 2^16 – 2 (65534) | 255.255.0.0 | /16 |
| C | 192 – 223 | 192.0.0.0 – 223.255.255.0 | 2^8 – 2 (254) | 255.255.255.0 | /24 |

>  номер сети 127.0.0.0 пропущен (относится к классу А), т.к. он зарезервирован и используется исключительно внутри хоста.

>  класс С заканчивается на 223, т.к. диапазон адресов 224.0.0.0-255.255.255.255 зарезервирован под различные протоколы


==Номер сети== – самый первый адрес в диапазоне, означающий этот диапазон. 
Например, 192.2.30.0 – номер сети (или Network Address), обозначает диапазон 192.2.30.0 – 192.2.30.255, также обозначает диапазон допустимых IP адресов 192.2.30.1 – 192.2.30.254 (о допустимых IP адресах рассказано ниже).


## Бесклассовая адресация
>Правила группировки адресов:
>- Все IP адреса в одной группе не должны быть разделены маршрутизатором (router).
>- Все IP адреса разделенные маршрутизатором должны быть в разных группах.

Бесклассовая адресация реализуется за счет займа бит из хостовой части.
То есть делим сети на *подсети* (_Подсеть_ — это логическое разделение сети)
==С бесклассовой адресацией можно дробить классовую и на более маленькие диапазоны==
![[classlessAddr_2_v2.png]]

==Бесклассовая адресация реализуется за счет **сетевой маски**, которая определяет какие биты будут относиться к номеру сети, а какие к хостовой части.==

==Префикс (prefix) – количество единиц в маске== (нужен для краткой записи маски)

>Формулы для вычисления кол-ва допустимых IP адресов (работает только для сложных масок):  
>Маска **четвертым октетом** определяет кол-во допустимых адресов, **формула – Х-2 (X – шаг)**  
>Маска **третьим октетом** определяет кол-во допустимых адресов, **формула – 256\*Х-2 (X – шаг)**  
>Маска **вторым октетом** определяет кол-во допустимых адресов, **формула – 256\*256\*Х-2 (X – шаг)**

## Типы IP-адресов
В IPv4 используется 3 типа адресов:
1.  *Индивидуальный (unicast)* - это адрес конкретного компьютера, именно такие адреса мы рассматривали выше.
2.  *Групповой (multicast)* - это адрес, который используется несколькими ПК. Если вы отправите данные на этот адрес, его получит несколько компьютеров в сети которые входит в эту группу.
3.  *Широковещательный (broadcast)* - это такой адрес, который используется для получения данных всеми компьютерами в сети.

![[Pasted image 20220111101741.png]]

### Широковещательный адрес

Широковещательный адрес в IP имеют следующий формат:
-   IP-адрес: 213.180.193.3/24
-   Широковещательный адрес: 213.180.193.255

Часть которая относится к адресу сети остается без изменений, а в той части, которая относится к адресу хоста записываются в битовые единицы.
Важным отличием широковещательных адресов в сетевом уровне, является то, что **широковещательные адреса используются только в пределах в одной подсети**.

Маршрутизаторы не передают широковещательные пакеты в другую сеть, иначе можно очень быстро завалить всю глобальную сеть, в том числе весь Интернет, мусорными широковещательными пакетами.


### Два широковещательных адреса
В IP используется 2 типа широковещательных адресов подходящих для двух различных сценарий
![[Pasted image 20220111102555.png]]

Если мы хотим отправить широковещательный пакет в рамках одной сети это называется ограниченное широковещание. В этом случае мы может использовать специальный  широковещательный адрес, который состоит из всех битовых единиц (255.255.255.255). В этом случае данные получат все компьютеры в сети, а через маршрутизатор данные не пройдут.


Когда компьютер,  который находится за пределами нашей сети, хочет передать широковещательный пакет всем компьютерам, которые находится в нашей сети это называется направленное широковещание. В этом случае широковещательный IP адрес будет выглядеть 192.168.0.255, адрес подсети, в которую мы хотим отправить широковещательный пакет и битовые единицы в той части, которая относится к адресу хоста. Пакет передаётся маршрутизатору и маршрутизатор уже разошлёт этот пакет в широковещательном режиме, но только в передах одной подсети, для которой предназначается этот широковещательный пакет.


### Особые IP адреса

В номере хоста нельзя использовать только битовые 0, и только битовые 1. Если мы укажем только битовые 0, то это получится не адрес хоста, а адрес подсети 213.180.193.0.

А если укажем только битовые 1, то это будет широковещательный адрес. 213.180.193.255.


В протоколе IP существует несколько соглашений об особой интерпретации IP-адресов:
- eсли весь IP-адрес состоит только из двоичных нулей, то он обозначает адрес того узла, который сгенерировал этот пакет; этот режим используется только в некоторых сообщениях ICMP;

- eсли в поле номера сети стоят только нули, то по умолчанию считается, что узел назначения принадлежит той же самой сети, что и узел, который отправил пакет;

- eсли все двоичные разряды IP-адреса равны 1, то пакет с таким адресом назначения должен рассылаться всем узлам, находящимся в той же сети, что и источник этого пакета. Такая рассылка называется ограниченным широковещательным сообщением (limited broadcast);

- eсли в поле номера узла назначения стоят только единицы, то пакет, имеющий такой адрес, рассылается всем узлам сети с заданным номером сети. Например, в сети 192.190.21.0 с маской 255.255.255.0 пакет с адресом 192.190.21.255 доставляется всем узлам сети этой сети. Такая рассылка называется широковещательным сообщением (broadcast).

==8.8.8.8== и ==8.8.4.4== - бесплатные, публичные DNS-серверы от Google
==127.0.0.1== - это адрес интернет-протокола loopback (IP), также называемый «localhost». Адрес используется для установления соединения с тем же компьютером, который используется конечным пользователем.
==192.168.1.3== - адрес частнйо сети
==192.268.1.3== - не существующий

## Как можно решить проблему исчерпания ip адресов

1.  Фундоментальное решение это использовать протокол [[IPv6-адреса| IPv6]]
2.  [[Технология NAT | Временная технология Network Address Translation (NAT)]], при этом вы строите сеть в которой используете частные адреса, в этой сети может быть большое количество компьютеров, а для того чтобы подключиться к Интернет вам нужен всего лишь один внешний IP адрес.




# Ссылки
___
##### Links


---
##### Источники
