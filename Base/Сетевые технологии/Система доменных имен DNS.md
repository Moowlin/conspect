202104212336
Tags:
___
# Система доменных имен DNS
![[dns.png]]

==Системы доменных имен  – DNS (англ. Domain Name System)== - компьютерная распределённая система для получения информации о доменах (сопоставление символических имен компьютеров и их IP-адресов)

DNS является распределённой системой, а значит она имеет множество узлов, каждый из которых ответственен за свою зону.

![[hierarchy.jpg]]

Система доменных имен позволяет: 
- использовать вместо ip-адресов символьные имена компьютера
- символьному имени определить ip-адрес

Преимущества DNS:
- понятные человеку имена
- возможность менять сетевую ифраструктуру
 
## Структура доменного имени
**Домен (доменное имя)** — символьное имя для обозначения сервера в сети интернет. Доменные имена являются иерархической структурой, в которой каждый уровень отделяется точкой и читаются **справа налево**. Важным элементом доменного имени, которое обычно не пишут, является корневой домен, он указывается точкой в конце. Основными уровнями являются:

- Корневой домен. В урле он не используется, но всегда подразумевается. От него начинается построение всех урлов в сети интернет
- Домены верхнего уровня. К ним относятся домены .ru, .com, .net, .su и так далее. Также этот домен называют доменом первого уровня.
- Домен второго уровня (или основной домен). Это основное имя вашего сайта
- Поддомены (домены третьего, четвёртого, пятого и т.д. уровня). Сюда входят все поддомены основного домена.

![[Domen_levels.jpg]]

# Доменная зона
**Доменная зона** - это правая часть полного доменного имени, как правило, состоит из 1-2 уровней
Доменные имена образуют дерево. Корнем дерева является корневой домен, который представлен точкой. Затем идут домены верхнего уровня, за нини домены второго и т.д.

Доменные зоны условно делятся на 2 большие подкатегории: 
- территориальные
	- ua– Украина;
	- ru – Россия;
	- by – Беларусь
- общего назначения
	- com – коммерческие компании; 
	- net – фирмы, отвечающие за работу интернета (провайдеры); 
	- info – информационные сайты (блоги); 
	- org – иные организации.  
Как правило, регистрация доменов – процедура свободная. Ее никто не контролирует, и документы не запрашивает. Поэтому владельцы сайтов вольны выбирать любую доменную зону. Но желательно придерживаться негласного правила, и регистрировать домен правильно.  


![[derevo-domen-imen.jpg]]


==DNS-сервер== — система, ответственная за хранение и поддержание в актуальном состоянии записей о своих дочерних доменах. Каждый DNS-сервер ответственен только за свою зону, то есть DNS-сервер домена .io знает о том, где расположен домен hexlet, DNS-сервер которого знает о расположении своих поддоменов.
==Корневой DNS-сервер== — система, знающая расположение (IP-адреса) DNS-серверов доменов верхнего уровня.
 ==Доменная зона== -  совокупность доменных имён определённого уровня, входящих в конкретный домен.
Доменные зоны распределены по серверам DNS.
Одну и ту же доменную зону может обслуживать несколько серверов DNS.


## Делегирование домена
для эффективной работы **DNS** разработана распределенная база данных, поддерживаемая с использование иерархии DNS-серверов. Структура взаимодействия DNS серверов представлена на рисунке.
![[Pasted image 20220211171326.png]]
Данная схема позволяет разгрузить сервер DNS по нескольким серверам DNS, что и выполняет распределенная база данных.

В основе иерархической структуры DNS лежит представление о доменном имени и зонах. Каждый DNS сервер, отвечающий за имя, может передать ответственность за дальнейшую часть домена другому серверу, что позволяет делегировать ответственность за вновь добавленную информацию на серверы различных организаций (людей), ответственных непосредственно только за «свою» часть доменного имени.

![[Pasted image 20220211171401.png]]

> Поскольку DNS поддерживает иерархию доменных имен, но никак не IP-адресов. Для решения “обратной” задачи есть специальный домен, структура которого совпадает со структурой IP-адресов. Называется этот домен **IN-ADDR.ARPA** .
> **in-addr.arpa** — специальная доменная зона, предназначенная для определения имени хоста по его IPv4-адресу, используя PTR-запись. Имена в домене IN-ADDR.ARPA образуют иерархию цифр, которые соответствуют IP-адресам. Правда, записываются эти имена в обратном порядке относительно написания IP-адреса.


==Делегирование== - операция передачи **ответственности** за часть дерева доменных имён другому лицу или организации. За счёт делегирования в DNS обеспечивается распределённость администрирования и хранения. Технически **делегирование** выражается в выделении этой части дерева в отдельную **зону**, и размещении этой **зоны** на **DNS-сервере**, управляемом этим лицом или организацией. При этом в родительскую зону включаются «склеивающие» **ресурсные записи** (NS и А), содержащие указатели на **DNS-сервера** дочерней зоны, а вся остальная информация, относящаяся к дочерней зоне, хранится уже на **DNS-серверах** дочерней зоны.

==DNS-сервер== - специализированное ПО для обслуживания DNS, а также компьютер, на котором это ПО выполняется. DNS-сервер может быть ответственным за некоторые зоны и/или может перенаправлять запросы вышестоящим серверам.
==DNS-клиент== - специализированная библиотека (или программа) для работы с DNS. В ряде случаев DNS-сервер выступает в роли DNS-клиента.

## Определение ip-адреса по доменному имени
Делаем это с помощью утилиты [[Команда nslookup| nslookup]] (преимущественно используется в Windows):
```
nslookup www.yandex.ru
Сервер: dc1.imm.uroran.ru
Address: 172.19.132.29
Не заслуживающий доверия ответ:
www.yandex.ru
Addresses: 2a02:6b8:a::a
77.88.55.55
77.88.55.66
5.255.255.5
5.255.255.55
```
В Linux - утилиты [[Команда host | host]], [[Команда dig | dig]]


# Режим работы DNS
Серверы DNS могут работать в двух режимах:
1.  Итеративный
	- Если сервер отвечает за данную доменную зону – он возвращает ответ
	- Если не отвечает, то возвращает адрес DNS-сервера, у которого есть более точная информация
2.  Рекурсивный 
	- Сервер сам выполняет запросы к другим серверам DNS, чтобы найти нужный адрес
	
	![[structure.jpg]]
	
Два режима работы необходимы, потому что в системе DNS используются два типа серверов.
1. DNS серверы, которые хранят информацию об отображении доменных имен в ip-адресах, работают в интеративном режиме, так как к этим серверам приходит большое количество запросов
2. серверы, которые занимаются разрешением имен для клиентов. Эти серверы работают в рекурсивном режиме, получают запрос от клиента, выполняют поиск в дереве серверов DNS, получают ответ и возвращают его клиенту.

## Сервер разрешения имен DNS

Предоставляется провайдером/организацией: 
- Компьютер получает адрес локального сервера DNS по [[ Протокол DHCP]]

Открытый сервер
- Google: 8.8.8.8 и 8.8.4.4
- Яндекс: 77.88.8.8 и 77.88.8.7 

## Кэширование
После того, как DNS resolver нашел ip-адрес для некоторого доменного имени, он записывает его в кэш, с одной стороны это хорошо так как повышают производительность работы, с другой стороны администратор зоны может поменять ip-адрес для некоторого компьютера, и если он у нас сохранен в кэше, то об изменении мы узнаем только через некоторое время.

## Типы ответов DNS
В DNS есть два типа ответов:

1. **Авторитетный** (в утилите nslookup windows —  authoritative «заслуживающий доверие»)
	- Ответ от сервера, обслуживающего доменную зону 
	- Получен из файлов на диске сервера
2. Неавторитетный (non-authoritative, “не заслуживающий доверия”)
	- Ответ от сервера, который не обслуживает доменную зону
	- Получен из кэша, данные могли устареть


## Инфраструктура DNS
Инфраструктура системы доменных имен состоит из следующих компонентов.
![[infrastructura-dns.jpg]]
- Дерево серверов DNS 
- Клиент DNS это как правило наш компьютер
- Сервер разрешения имен DNS (DNS resolver), он получает запрос от клиента и выполняет поиск необходимого ip-адреса в дереве доменных имен.


## Распределение доменных имен
 Распределением доменных имен занимаются специализированные организации - регистраторы.
 
 ## Whois сервис
 Сервис Whois позволяет быстро получить всю информацию о регистрации домена, например, дату регистрации и возраст домена, или узнать контакты, по которым можно связаться с организацией или человеком, чей домен вас заинтересовал.
 




# Ссылки
___
##### Links
[[Протокол DNS]]

---
##### Источники

https://guides.hexlet.io/dns/?utm_source=facebook.com&amp;utm_medium=social&amp;utm_ca
https://habr.com/ru/post/303446/
https://zvondozvon.ru/tehnologii/protokoli/dns
https://pc.ru/docs/network/dns
http://rus-linux.net/MyLDP/BOOKS/Linux-Servers/toc.html